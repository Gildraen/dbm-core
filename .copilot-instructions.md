# GitHub Copilot Instructions

## Package Manager

- Use `yarn` instead of `npm` for all package management commands
- Use `yarn add` for runtime dependencies
- Use `yarn add -D` for dev dependencies
- Use `yarn install --frozen-lockfile` in CI/CD
- Use `yarn workspace` commands for monorepo operations

## Code Style & Standards

- Use TypeScript for all new files
- Prefer arrow functions over function declarations
- Use 2 spaces for indentation
- Always use semicolons
- Prefer const/let over var
- Use absolute imports with `app/` prefix (mapped to `src/` in tsconfig)
  - Example: `import { Config } from 'app/domain/config/Config'`
  - Example: `import { ModuleLoader } from 'app/domain/service/ModuleLoader'`
- Follow clean architecture patterns (domain, application, infrastructure layers)

## Project Structure

- Follow the established layered architecture:
  - `src/domain/` - Core business logic, entities, value objects
  - `src/application/` - Use cases and application services
  - `src/infrastructure/` - External concerns (CLI, databases, APIs)
- Place interfaces in `src/domain/interface/`
- Place types in `src/domain/types/`
- Use `tests/` directory mirroring `src/` structure

## Testing

- Use Vitest for testing (already configured)
- Place tests in `tests/` directory with same folder structure as `src/`
- Use `.test.ts` suffix for test files
- Write unit tests for domain logic
- Write integration tests for use cases
- Aim for high test coverage

## Git Workflow

- Main branch: `main`
- Feature branches: `feature/description` or `fix/description`
- Use conventional commits format
- Create PRs for all changes to main

## PR Creation Guidelines

### When User Requests PR Creation

When a user asks for a PR (pull request), always provide both:

1. **PR Title** - Concise, descriptive, following conventional commit format
2. **PR Message** - Comprehensive description following the template below

### PR Title Format

Use conventional commit format:

- `feat: add new feature description`
- `fix: resolve specific issue`
- `refactor: improve code structure`
- `docs: update documentation`
- `test: add or improve tests`
- `ci: update CI/CD configuration`
- `perf: improve performance`
- `style: code formatting changes`

### PR Message Template

Always include these sections:

```markdown
# üöÄ [Type]: [Brief Description]

## Overview

Explain what this PR does and why it's needed.

## üèóÔ∏è Changes Made

### [Category 1 - e.g., Architecture, Features, etc.]

- Bullet point of specific changes
- Use action verbs and be specific
- Include file names or components when relevant

### [Category 2 - e.g., Testing, Configuration, etc.]

- More bullet points
- Focus on what was actually changed

## üîß Technical Details

### Code Changes

- List significant code modifications
- Mention new patterns or approaches used
- Note any architectural decisions

### Configuration Changes

- List any config file updates
- Mention environment variable changes
- Note any setup requirements

## üõ°Ô∏è Quality Assurance

### Testing

- [x] All existing tests pass
- [x] New tests added for new functionality
- [x] Test coverage maintained/improved

### Code Quality

- [x] TypeScript compilation successful
- [x] ESLint passes without errors
- [x] Follows project coding standards

## üì¶ Package/Build Changes

(If applicable)

- List any package.json changes
- Mention build process updates
- Note any breaking changes

## üîÑ Migration/Compatibility

- State if this is a breaking change (YES/NO)
- List migration steps if needed
- Note backward compatibility status

## üöÄ Benefits/Impact

- Explain the benefits this PR brings
- Mention performance improvements
- Note developer experience improvements

---

Ready for review and testing.
```

### PR Creation Process

1. **Analyze the changes** made in the conversation
2. **Generate appropriate title** using conventional commit format
3. **Create comprehensive message** following the template
4. **Tailor content** to the specific changes made
5. **Include relevant technical details** and code examples
6. **Highlight benefits** and impact of the changes

### Example Usage

When user says "create a PR" or "make PR message":

- Review conversation history for changes made
- Identify the main type of change (feat, fix, refactor, etc.)
- Create title and detailed message
- Save to a `FINAL_PR_MESSAGE.md` file for easy copying

## Release Strategy

- No automatic releases from main branch
- Use GitHub releases for stable versions
- Beta releases can be published from main for testing
- Manual release process preferred

## Discord Bot Specific

- Follow Discord.js patterns and best practices
- Use slash commands over legacy message commands
- Implement proper error handling for Discord API calls
- Use TypeScript types for Discord interactions

## Configuration

- Use environment-based configuration
- Store sensitive data in environment variables
- Validate configuration at startup
- Use the existing ConfigManager pattern

## Error Handling

- Use Result/Either patterns for error handling
- Avoid throwing exceptions in domain logic
- Log errors appropriately with context
- Return meaningful error messages

## Code Organization

- Keep functions small and focused
- Use dependency injection where appropriate
- Follow SOLID principles
- Prefer composition over inheritance
- Use TypeScript strict mode features
